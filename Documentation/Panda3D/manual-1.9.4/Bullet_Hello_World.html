<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <title>Bullet Hello World - Panda3D Manual</title>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="style.css" type="text/css"><link rel="shortcut icon" href="favicon.ico">    <meta name="keywords" content="Panda3D, Panda, 3D, Python, graphics, free, game, engine, game rendering engine, simulation, open source, free download, Disney, ETC, Entertainment Technology Center, open-source">
    <meta name="description" content="Free open source 3D game and simulation engine developed by Disney and maintained by Carnegie Mellon University\'s Entertainment Technology Center">
    </head>
    <body>
<table width=960 cellpadding=0 cellspacing=0 id=main align=center>
<tr>
<td id=borderleft></td>
<td id=maincenter valign=top>
<table id=container width="100%" cellpadding=0 cellspacing=0 align=center><tr><td id=pcontent valign=top><h2>Panda3D Manual: Bullet Hello World</h2>
<div style="width:100%; padding: 1px;" class=subnavigation>
<table width="640px" cellpadding="0" cellspacing="0" border="0">
              <tr>
              <td width="70px" align="left">&nbsp;&nbsp;<a style="text-decoration:none" href="Using_Bullet_with_Panda3D.html"><img border=0 width=16 height=16 src="arrow_left.png" align=absmiddle> <u>Prev</u></a></td>
              <td width="70px" align="center"><a style="text-decoration:none" href="Main_Page.html"><img border=0 width=16 height=16 src="arrow_up.png" align=absmiddle><u>Top</u></a></td>
              <td width="70px" align="right"><a style="text-decoration:none" href="Bullet_Debug_Renderer.html"><u>Next</u> <img border=0 width=16 height=16 src="arrow_right.png" align=absmiddle></a>&nbsp;&nbsp;</td>
              </tr></table></div><div class='wikicontent' id='wikicontentid'><p>This page intends to lead through a minimal "hello world" program using Panda3D and Bullet physics.
</p><p>
</p>
<h2> <span class="mw-headline" id="World">World</span></h2>
<p>In order to use Bullet physics we need to have a BulletWorld. The world is Panda3D's term for a <i>"space"</i> or <i>"scene"</i>. The world holds physical objects like rigid bodies, soft bodies or character controllers. It controls global parameters, such a gravity, and it advances the simulation state.
</p>
<pre class="python"><span style="color: #ff7700;font-weight:bold;">from</span> panda3d.<span style="color: black;">bullet</span> <span style="color: #ff7700;font-weight:bold;">import</span> BulletWorld<br />world = BulletWorld<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br />world.<span style="color: black;">setGravity</span><span style="color: black;">&#40;</span>Vec3<span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">-9.81</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span></pre>
<p>
</p><p>The above code creates a new world, and it sets the worlds gravity to a downward vector with length 9.81. While Bullet is in theory independent from any particular units it is recommended to stick with SI units (kilogram, meter, second). In SI units 9.81 m/sÂ² is the gravity on Earth's surface.
</p><p>Next we need to advance the simulation state. This is best done by a task which gets called each frame. We find out about the elapsed time (dt), and pass this value to the <code>doPhysics</code> method.
</p>
<pre class="python"><span style="color: #ff7700;font-weight:bold;">def</span> update<span style="color: black;">&#40;</span>task<span style="color: black;">&#41;</span>:<br />  dt = globalClock.<span style="color: black;">getDt</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br />  world.<span style="color: black;">doPhysics</span><span style="color: black;">&#40;</span>dt<span style="color: black;">&#41;</span><br />  <span style="color: #ff7700;font-weight:bold;">return</span> task.<span style="color: black;">cont</span><br />&#160;<br />taskMgr.<span style="color: black;">add</span><span style="color: black;">&#40;</span>update, <span style="color: #483d8b;">'update'</span><span style="color: black;">&#41;</span></pre>
<p>
</p><p>The <code>doPhysics</code> method allows finer control on the way the simulation state is advanced. Internally Bullet splits a timestep into several substeps. We can pass a maximum number of substeps and the size of each substep, like show in the following code.
</p>
<pre class="python">world.<span style="color: black;">doPhysics</span><span style="color: black;">&#40;</span>dt, <span style="color: #ff4500;">10</span>, <span style="color: #ff4500;">1.0</span>/<span style="color: #ff4500;">180.0</span><span style="color: black;">&#41;</span></pre>

<p>Here we have a maximum of 10 substeps, each with 1/180 seconds. Choosing smaller substeps will make the simulation more realistic, but performance will decrease too. Smaller substeps also reduce jitter.
</p><p><br />
</p>
<h2> <span class="mw-headline" id="Static_bodies">Static bodies</span></h2>
<p>So far we just have an empty world. We next need to add some objects. The most simple objects are static bodies. Static object don't change their position or orientation with time. Typical static objects are the ground or terrain, and houses or other non-moveable obstacles. Here we create a simple plane which will serve as a ground.
</p>
<pre class="python"><span style="color: #ff7700;font-weight:bold;">from</span> panda3d.<span style="color: black;">bullet</span> <span style="color: #ff7700;font-weight:bold;">import</span> BulletPlaneShape<br /><span style="color: #ff7700;font-weight:bold;">from</span> panda3d.<span style="color: black;">bullet</span> <span style="color: #ff7700;font-weight:bold;">import</span> BulletRigidBodyNode<br />&#160;<br />shape = BulletPlaneShape<span style="color: black;">&#40;</span>Vec3<span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>, <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span><br />&#160;<br />node = BulletRigidBodyNode<span style="color: black;">&#40;</span><span style="color: #483d8b;">'Ground'</span><span style="color: black;">&#41;</span><br />node.<span style="color: black;">addShape</span><span style="color: black;">&#40;</span>shape<span style="color: black;">&#41;</span><br />&#160;<br />np = render.<span style="color: black;">attachNewNode</span><span style="color: black;">&#40;</span>node<span style="color: black;">&#41;</span><br />np.<span style="color: black;">setPos</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">-2</span><span style="color: black;">&#41;</span><br />&#160;<br />world.<span style="color: black;">attachRigidBody</span><span style="color: black;">&#40;</span>node<span style="color: black;">&#41;</span></pre>

<p>First we create a collision shape, in the case a <code>BulletPlaneShape</code>. We pass the plane's constant and normal vector within the shape's constructor. There is a separate page about setting up the various collision shapes offered by Bullet, so we won't go into more detail here.
</p><p>Next we create a rigid body and add the previously created shape. <code>BulletRigidBodyNode</code> is derived from <code>PandaNode</code>, and thus the rigid body can be placed within the Panda3D scene graph. you can also use methods like <code>setPos</code> or <code>setH</code> to place the rigid body node where you want it to be.
</p><p>Finally we need to attach the newly created rigid body node to the world. Only rigid bodies attached to the world will be considered when advancing the simulation state.
</p>
<h2> <span class="mw-headline" id="Dynamic_bodies">Dynamic bodies</span></h2>
<p>Dynamic bodies are similar to static bodies. Except that dynamic bodies can be moved around the world by applying force or torque. To setup a dynamic body is almost the same as for static bodies. We will have to set one additional property though, the body's mass. Setting a positive finite mass will create a dynamic body, while setting the mass to zero will create a static body. Zero mass is a convention for setting an <i>infinite</i> mass, which is the same as making the body unmovable (static). 
</p>
<pre class="python"><span style="color: #ff7700;font-weight:bold;">from</span> panda3d.<span style="color: black;">bullet</span> <span style="color: #ff7700;font-weight:bold;">import</span> BulletBoxShape<br />&#160;<br />shape = BulletBoxShape<span style="color: black;">&#40;</span>Vec3<span style="color: black;">&#40;</span><span style="color: #ff4500;">0.5</span>, <span style="color: #ff4500;">0.5</span>, <span style="color: #ff4500;">0.5</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><br />&#160;<br />node = BulletRigidBodyNode<span style="color: black;">&#40;</span><span style="color: #483d8b;">'Box'</span><span style="color: black;">&#41;</span><br />node.<span style="color: black;">setMass</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1.0</span><span style="color: black;">&#41;</span><br />node.<span style="color: black;">addShape</span><span style="color: black;">&#40;</span>shape<span style="color: black;">&#41;</span><br />&#160;<br />np = render.<span style="color: black;">attachNewNode</span><span style="color: black;">&#40;</span>node<span style="color: black;">&#41;</span><br />np.<span style="color: black;">setPos</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">2</span><span style="color: black;">&#41;</span><br />&#160;<br />world.<span style="color: black;">attachRigidBody</span><span style="color: black;">&#40;</span>node<span style="color: black;">&#41;</span></pre>
<p>
</p><p>Bullet will automatically update a rigid body node's position and orientation if is has changed after advancing the simulation state. So, if you have a <code>GeomNode</code> - e. g. a textured box - and reparent this geom node below the rigid body node, then the geom node will move around together with the rigid body. You don't have to synchronize the visual world with the physics world.
</p><p><br />
</p>
<h2> <span class="mw-headline" id="The_Program">The Program</span></h2>
<p>Let's put everything learned on this page together into a single script, which is shown below. It assumes that you have an .egg model of a 1 by 1 by 1 box.
</p><p>when running the script you will see a box falling down onto an invisible plane. The plane is invisible simply because we didn't parent a visual mode below the plane's rigid body node. Of course we could have done so. 
</p><p>The model cube.egg used in this hello word sample can be found in the following archive: <a rel="nofollow" class="external free" href="http://www.panda3d.org/download/noversion/bullet-samples.zip">https://www.panda3d.org/download/noversion/bullet-samples.zip</a> 
</p><p><br />
</p>
<pre class="python"><span style="color: #ff7700;font-weight:bold;">import</span> direct.<span style="color: black;">directbase</span>.<span style="color: black;">DirectStart</span><br /><span style="color: #ff7700;font-weight:bold;">from</span> panda3d.<span style="color: black;">core</span> <span style="color: #ff7700;font-weight:bold;">import</span> Vec3<br /><span style="color: #ff7700;font-weight:bold;">from</span> panda3d.<span style="color: black;">bullet</span> <span style="color: #ff7700;font-weight:bold;">import</span> BulletWorld<br /><span style="color: #ff7700;font-weight:bold;">from</span> panda3d.<span style="color: black;">bullet</span> <span style="color: #ff7700;font-weight:bold;">import</span> BulletPlaneShape<br /><span style="color: #ff7700;font-weight:bold;">from</span> panda3d.<span style="color: black;">bullet</span> <span style="color: #ff7700;font-weight:bold;">import</span> BulletRigidBodyNode<br /><span style="color: #ff7700;font-weight:bold;">from</span> panda3d.<span style="color: black;">bullet</span> <span style="color: #ff7700;font-weight:bold;">import</span> BulletBoxShape<br />&#160;<br />base.<span style="color: black;">cam</span>.<span style="color: black;">setPos</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">-10</span>, <span style="color: #ff4500;">0</span><span style="color: black;">&#41;</span><br />base.<span style="color: black;">cam</span>.<span style="color: black;">lookAt</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span><span style="color: black;">&#41;</span><br />&#160;<br /><span style="color: #808080; font-style: italic;"># World</span><br />world = BulletWorld<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br />world.<span style="color: black;">setGravity</span><span style="color: black;">&#40;</span>Vec3<span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">-9.81</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><br />&#160;<br /><span style="color: #808080; font-style: italic;"># Plane</span><br />shape = BulletPlaneShape<span style="color: black;">&#40;</span>Vec3<span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span>, <span style="color: #ff4500;">1</span><span style="color: black;">&#41;</span><br />node = BulletRigidBodyNode<span style="color: black;">&#40;</span><span style="color: #483d8b;">'Ground'</span><span style="color: black;">&#41;</span><br />node.<span style="color: black;">addShape</span><span style="color: black;">&#40;</span>shape<span style="color: black;">&#41;</span><br />np = render.<span style="color: black;">attachNewNode</span><span style="color: black;">&#40;</span>node<span style="color: black;">&#41;</span><br />np.<span style="color: black;">setPos</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">-2</span><span style="color: black;">&#41;</span><br />world.<span style="color: black;">attachRigidBody</span><span style="color: black;">&#40;</span>node<span style="color: black;">&#41;</span><br />&#160;<br /><span style="color: #808080; font-style: italic;"># Box</span><br />shape = BulletBoxShape<span style="color: black;">&#40;</span>Vec3<span style="color: black;">&#40;</span><span style="color: #ff4500;">0.5</span>, <span style="color: #ff4500;">0.5</span>, <span style="color: #ff4500;">0.5</span><span style="color: black;">&#41;</span><span style="color: black;">&#41;</span><br />node = BulletRigidBodyNode<span style="color: black;">&#40;</span><span style="color: #483d8b;">'Box'</span><span style="color: black;">&#41;</span><br />node.<span style="color: black;">setMass</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">1.0</span><span style="color: black;">&#41;</span><br />node.<span style="color: black;">addShape</span><span style="color: black;">&#40;</span>shape<span style="color: black;">&#41;</span><br />np = render.<span style="color: black;">attachNewNode</span><span style="color: black;">&#40;</span>node<span style="color: black;">&#41;</span><br />np.<span style="color: black;">setPos</span><span style="color: black;">&#40;</span><span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">0</span>, <span style="color: #ff4500;">2</span><span style="color: black;">&#41;</span><br />world.<span style="color: black;">attachRigidBody</span><span style="color: black;">&#40;</span>node<span style="color: black;">&#41;</span><br />model = loader.<span style="color: black;">loadModel</span><span style="color: black;">&#40;</span><span style="color: #483d8b;">'models/box.egg'</span><span style="color: black;">&#41;</span><br />model.<span style="color: black;">flattenLight</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br />model.<span style="color: black;">reparentTo</span><span style="color: black;">&#40;</span>np<span style="color: black;">&#41;</span><br />&#160;<br /><span style="color: #808080; font-style: italic;"># Update</span><br /><span style="color: #ff7700;font-weight:bold;">def</span> update<span style="color: black;">&#40;</span>task<span style="color: black;">&#41;</span>:<br />  dt = globalClock.<span style="color: black;">getDt</span><span style="color: black;">&#40;</span><span style="color: black;">&#41;</span><br />  world.<span style="color: black;">doPhysics</span><span style="color: black;">&#40;</span>dt<span style="color: black;">&#41;</span><br />  <span style="color: #ff7700;font-weight:bold;">return</span> task.<span style="color: black;">cont</span><br />&#160;<br />taskMgr.<span style="color: black;">add</span><span style="color: black;">&#40;</span>update, <span style="color: #483d8b;">'update'</span><span style="color: black;">&#41;</span><br />run<span style="color: black;">&#40;</span><span style="color: black;">&#41;</span></pre>
<p>

<!-- 
NewPP limit report
Preprocessor node count: 196/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key mw_manual:pcache:idhash:2606-0!*!*!!en!*!* and timestamp 20171008020131 -->
</div><div style="width:100%; padding: 1px;" class=subnavigation>
<table width="640px" cellpadding="0" cellspacing="0" border="0">
              <tr>
              <td width="70px" align="left">&nbsp;&nbsp;<a style="text-decoration:none" href="Using_Bullet_with_Panda3D.html"><img border=0 width=16 height=16 src="arrow_left.png" align=absmiddle> <u>Prev</u></a></td>
              <td width="70px" align="center"><a style="text-decoration:none" href="Main_Page.html"><img border=0 width=16 height=16 src="arrow_up.png" align=absmiddle><u>Top</u></a></td>
              <td width="70px" align="right"><a style="text-decoration:none" href="Bullet_Debug_Renderer.html"><u>Next</u> <img border=0 width=16 height=16 src="arrow_right.png" align=absmiddle></a>&nbsp;&nbsp;</td>
              </tr></table></div><div id=legal>&copy; Carnegie Mellon University 2010</div></td></tr></table></td><td id=borderright></td></tr></table></body></html>